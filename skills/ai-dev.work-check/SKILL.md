---
name: ai-dev.work-check
description: 6개 병렬 버그 체커로 구현된 코드의 버그를 탐색. "버그 검사", "work check", "워크 체크" 요청 시 활성화.
---

# Skill: ai-dev.work-check

6개 전문화된 버그 체커가 병렬로 구현된 코드를 검사합니다.

---

## 목적

- 엣지 케이스, 경계값 버그 탐지
- 동시성 및 상태 관련 버그 탐지
- 메모리 누수 및 리소스 관리 문제 탐지
- 입력 검증 및 보안 취약점 탐지
- 회귀 버그 가능성 평가

---

## ai-dev.review와의 차이

| 항목 | ai-dev.work-check | ai-dev.review |
|------|-------------------|---------------|
| **목적** | 버그 사전 탐지 | 최종 승인 판정 |
| **방식** | 6개 전문 체커 병렬 | 종합 리뷰 |
| **초점** | 기술적 버그 | 비즈니스 규칙 + 기술 |
| **출력** | 버그 리포트 + 재현 시나리오 | 승인/변경요청 |

---

## 사용 시점

- `/ai-dev.work-check PK-XXXXX` - 버그 검사 시작
- `ai-dev.code-check` 완료 후, `ai-dev.review` 실행 전
- 중요 기능 구현 후 자체 점검

---

## 워크플로우

```
┌─────────────────────────────────────────────────────────────────┐
│                    ai-dev.work-check 워크플로우                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  [Step 1] 문서 및 코드 로드                                      │
│  spec.md + plan.md + 변경된 코드                                │
│                                                                 │
│  [Step 2] 6개 Bug Checkers 병렬 실행                            │
│  ┌────────────┬────────────┬────────────┐                      │
│  │ Edge Case  │ Race       │ State      │                      │
│  │ Hunter     │ Condition  │ Corruption │                      │
│  │            │ Detector   │ Finder     │                      │
│  ├────────────┼────────────┼────────────┤                      │
│  │ Memory     │ Input      │ Regression │                      │
│  │ Leak       │ Validation │ Detector   │                      │
│  │ Hunter     │ Checker    │            │                      │
│  └─────┬──────┴─────┬──────┴─────┬──────┘                      │
│        └────────────┼────────────┘                              │
│                     ▼                                           │
│  [Step 3] Bug Triage                                            │
│  심각도 분류 + 재현 시나리오 작성                                 │
│                     ▼                                           │
│  [Step 4] 리포트 생성                                            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6개 Bug Checkers

### 1. Edge Case Hunter (엣지 케이스)

**역할**: 경계값 및 특수 입력 버그 탐지

**검증 항목**:
- nil/empty 입력 처리
- 경계값 (0, -1, MAX_INT, 빈 배열)
- 특수문자, 유니코드, 이모지
- 극단적 길이 (매우 짧거나 긴 문자열)

**프롬프트 요약**:
```
각 함수/메서드에 대해 엣지 케이스를 분석하세요:
- nil/empty 입력 시 어떻게 동작하나요?
- 경계값 (0, -1, MAX) 처리는 안전한가요?
- 빈 배열/딕셔너리에서 크래시가 발생하나요?
- 특수문자/이모지 입력 시 문제가 있나요?

버그 발견 시 재현 시나리오를 작성하세요.
```

### 2. Race Condition Detector (동시성)

**역할**: 동시성 및 비동기 버그 탐지

**검증 항목**:
- 공유 상태 변수 동시 접근
- async/await 순서 의존성
- 여러 스레드 동시 접근 시나리오
- 데드락 가능 조건
- Main thread에서 UI 업데이트

**프롬프트 요약**:
```
동시성 관련 버그를 찾으세요:
- 공유 상태에 여러 스레드가 접근하나요?
- async 작업의 순서가 보장되나요?
- UI 업데이트가 Main thread에서 이루어지나요?
- 데드락 가능성이 있나요?

특히 @MainActor, DispatchQueue, Task 사용을 확인하세요.
```

### 3. State Corruption Finder (상태 오염)

**역할**: 잘못된 상태 전이 및 불일치 탐지

**검증 항목**:
- 불가능한 상태 조합
- 잘못된 상태 전이 (A→C, A→B→C만 허용인데)
- 초기화 전 접근
- 클린업 누락으로 인한 잔여 상태

**프롬프트 요약**:
```
상태 관리 버그를 찾으세요:
- 불가능한 상태 조합이 발생할 수 있나요?
- 상태 전이가 올바른 순서로만 가능한가요?
- 초기화 전에 변수에 접근하는 경우가 있나요?
- 화면 이탈 시 상태가 제대로 정리되나요?

Reactor/ViewModel의 State 변경을 중점적으로 확인하세요.
```

### 4. Memory Leak Hunter (메모리 누수)

**역할**: 메모리 누수 및 리소스 관리 문제 탐지

**검증 항목**:
- [weak self] 누락된 closure
- delegate weak 참조 여부
- NotificationCenter observer 해제 누락
- Timer invalidate 누락
- 순환 참조 구조

**프롬프트 요약**:
```
메모리 누수 가능성을 찾으세요:
- closure에서 self 캡처 시 [weak self] 사용했나요?
- delegate가 weak으로 선언되었나요?
- NotificationCenter observer가 deinit에서 해제되나요?
- Timer가 invalidate 되나요?

retain cycle이 발생할 수 있는 구조를 식별하세요.
```

### 5. Input Validation Checker (입력 검증)

**역할**: 입력 검증 및 보안 취약점 탐지

**검증 항목**:
- 사용자 입력 검증 (타입, 범위, 길이)
- API 응답 타입 안전성
- JSON 디코딩 실패 처리
- SQL injection / XSS 가능성
- 민감 데이터 노출

**프롬프트 요약**:
```
입력 검증 문제를 찾으세요:
- 사용자 입력이 검증 없이 사용되나요?
- API 응답이 예상과 다를 때 크래시가 발생하나요?
- JSON 디코딩 실패 시 graceful하게 처리되나요?
- organization_id 필터링이 누락되었나요?
- 민감 데이터가 로그에 출력되나요?
```

### 6. Regression Detector (회귀 버그)

**역할**: 기존 기능에 미치는 영향 평가

**검증 항목**:
- 변경된 인터페이스의 호출자 영향
- 기존 테스트 커버리지
- 숨겨진 의존성
- 사이드 이펙트 전파

**프롬프트 요약**:
```
회귀 버그 가능성을 평가하세요:
- 변경한 함수/클래스를 다른 곳에서 사용하나요?
- 해당 기능에 대한 기존 테스트가 있나요?
- 변경이 다른 기능에 영향을 미치나요?
- 인터페이스 변경으로 컴파일 에러가 발생할 수 있나요?

Grep으로 변경된 함수/클래스 사용처를 모두 확인하세요.
```

---

## 심각도 분류 (P0-P3)

| Level | 의미 | 예시 | 조치 |
|-------|------|------|------|
| **P0** | Critical | 크래시, 데이터 손실, 보안 취약점 | 필수 수정 |
| **P1** | High | 기능 오작동, 성능 저하 | 수정 권장 |
| **P2** | Medium | 엣지 케이스 미처리, 경미한 오류 | 선택적 수정 |
| **P3** | Low | 코드 스멜, 잠재적 문제 | 참고 |

---

## Bug Triage (Step 3)

모든 발견 집계 후:

1. **심각도 재평가**: 체커별 판단 검토
2. **중복 제거**: 같은 버그를 여러 체커가 발견한 경우
3. **재현 시나리오 작성**: P0/P1 버그에 대해 상세 시나리오
4. **수정 우선순위 결정**: 영향도 기반

---

## 출력 템플릿

```markdown
# {TICKET_ID} Bug Check Report

**검증일**: YYYY-MM-DD HH:MM
**검사자**: 6 Parallel Bug Checkers

---

## 요약

| Checker | 발견 | P0 | P1 | P2 | P3 |
|---------|------|----|----|----|----|
| Edge Case Hunter | N | N | N | N | N |
| Race Condition | N | N | N | N | N |
| State Corruption | N | N | N | N | N |
| Memory Leak | N | N | N | N | N |
| Input Validation | N | N | N | N | N |
| Regression | N | N | N | N | N |
| **총계** | **N** | **N** | **N** | **N** | **N** |

---

## P0 Critical Bugs

### [BUG-001] {버그 제목}

**발견자**: {Checker 이름}
**파일**: `{파일}:{라인}`
**심각도**: P0 (Critical)

**설명**:
{버그 설명}

**재현 시나리오**:
```
전제조건: {조건}

1. {단계 1}
2. {단계 2}
3. {단계 3}

예상 결과: {예상}
실제 결과: {실제 - 크래시/오류}
```

**영향 범위**:
- {영향받는 기능/사용자}

**수정 제안**:
```diff
- 문제 코드
+ 수정 코드
```

---

## P1 High Priority Bugs

### [BUG-010] {버그 제목}
...

---

## P2 Medium Priority Bugs

### [BUG-020] {버그 제목}
...

---

## P3 Low Priority (참고)

| # | 버그 | Checker | 파일 |
|---|------|---------|------|
| BUG-030 | {버그} | {Checker} | {파일} |

---

## 판정

| 조건 | 결과 |
|------|------|
| **Work 승인** | ✅ 통과 / ❌ 수정 필요 |
| P0 버그 | N건 (0이어야 통과) |
| P1 버그 | N건 (수정 권장) |

---

## 권장 조치

### 필수 (Blocking)
1. [ ] [BUG-001] {P0 버그 수정}

### 권장 (Non-blocking)
1. [ ] [BUG-010] {P1 버그 수정}
2. [ ] [BUG-011] {P1 버그 수정}

---

## 다음 단계

- ✅ P0 없음: `/ai-dev.review` 진행
- ❌ P0 존재: 필수 조치 완료 후 재검증

---

*Checked by ai-dev.work-check (6 parallel bug checkers)*
```

---

## 파일 경로

```
~/.claude/contexts/work/kidsnote/docs/ai-dev/{PK-xxxx}/
├── ...
└── work-check-report.md  ← 생성
```

---

## 연계 스킬

| 스킬 | 용도 |
|------|------|
| `/ai-dev.code-check` | 선행 (품질 검증) |
| `/ai-dev.review` | 후속 (최종 승인) |

---

**Created:** 2026-01-28
**Version:** 1.0
